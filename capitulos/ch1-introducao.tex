% ==============================================================================
% Capítulo 1 - Introdução
% ==============================================================================
\chapter{Introdução}
\label{sec-intro}

Equações diferencias são equações que descrevem uma relação entre uma função
e suas derivadas, são de particular interesse para as ciências naturais
por sua aplicação na modelagem de fenômenos naturais e de leis físicas.
A principal distinção entre elas é feita pelo número de variáveis independentes,
no caso de apenas uma variável, chama-se de equação parcial ordinária (EDO),
e equação diferencial parcial (EDP) para o caso mais de uma variável independente.
Muitas das equações de interesse para áreas como engenharia, física, 
ecologia, química e epidemiológia, apenas para nomear algumas áreas, 
não possuem soluções analíticas conhecidas, fazendo com a busca por métodos 
númericos seja uma área de pesquisa ativa da matemática aplicada. 
Ao longo dos século passado, foram desenvolvidos métodos para a solução de 
equações, como o método de diferenças finitas (MDF) e o 
método de elementos finitos (MEF).
Entretanto é necessário uma discretização do domínio das equações, gerando uma 
malha de pontos em que a solução será resolvida.
A criação desta malha (\textit{mesh}) não é uma tarefa trivial, e a qualidade 
da solução obtida está diretamente ligada a obtenção desta malha \cite{raissi-etal:19}.
Logo, há um interesse em métodos que não necessitem de malhas. 

Uma redes neural artificial, ou apenas redes neurais, são um modelo de computação 
inspirado no funcionamento do cérebro, seu desenvolvimento remonta a trabalhos
pioneiros ainda nos anos 40 como \cite{mcculloch-pitts:1943-perceptron}.
O pontencial que redes neurais têm como solucionadores númericos de equações
diferencias pode ser facilmente observado, pois redes neurais são aproximadores
universais, ou seja são capazes de aproximar qualquer função, inclusive uma 
que seja a solução de uma equação diferencial.
Esta propriedade é atestada pelo teorema da aproximação universal, 
demonstrado primeiramente para redes com
largura arbritária e função sigmóide por \cite{cybenko:89}, e para redes 
com no minímo uma camada escondida por \cite{hornik:89-aprox-universais}. 
A versão do teorema demonstrada nesses artigos, atesta que
que redes neurais com uma largura suficientemente grande são capazes de aproximar 
qualquer função. Anos depois, em \cite{grippen:03-aprox-universais-profundidade},
a mesma propriedade foi demonstrada para redes com profundidade arbritária 
e largura fixa.

O pontencial das redes neurais para a solução numérica de equações diferencias 
já havia percebido nos anos 90, em trabalhos como \cite{psichogios-etal:92} que
incorporou uma rede neural na modelagem de um bioreator para a estimativa de
parâmetros que seriam difíceis de de serem estimados apenas com princípios físicos 
e químicos. Trabalhos seguintes focariam em propor métodos para a solução de 
quelquer equação diferencial através de redes neurais. 
Um exemplo que pode ser citado é \cite{meade-fernandez:94}, sendo um dos 
primeiros a criar uma forma para solucinar EDOs arbritárias utilizando redes 
neurais, entretanto o método proposto necessita que certas limitações sejam
impostas às entredas, pesos e vièses da rede. 
Um outro exemplo de proposta para a solução de qualquer equação diferencial é
encontrada  em \cite{lagaris-etal:98}, sendo um dos prmeiros trabalhos a 
propor um método não apenas para a solução de EDOs, mas também para sistemas 
de EDOs e até mesmo EDPs.
Os autores separaram o problema em duas partes, as equações diferenciais em sí e 
as condições de fronteira, sendo a primeira parte aproximada por uma rede neural
\textit{feedfoward}, e a segunda parte é obtida por meio de restrições duras 
(\textit{hard constraints}) impostas ao modelo.

Uma série de métodos alternativos, ou seja, que não usam apenas redes neurais 
\textit{feedfoward} como base, foram propostos utilizando redes neurais para
a solução de equações diferenciais nos últimos anos. 
Como exemplo, pode-se citar as \textit{Neural ODE} \cite{chen-etal:2018-neural-ode}, 
pensadas para a resolução de EDOs, o método define a evolução de uma EDO 
(interpretando a variável independente como sendo o tempo) como uma rede neural,
criado uma solução continua para a EDO, em oposição às redes \textit{feedfoward},
em que representam a evolução do sistema por meio de camadas discretas.  
Outro exemplo é o \textit{DeepGalerkin} \cite{sirignano-spiliopoulos:2018-deepgalerkin}
que combina o pricípio do método de Galerkin de solucionar uma EDP em partes do
domínio, mas utiliza uma rede neural profunda para aproximar as soluções no lugar 
de métodos lineares aplicados a um conjunto de funções de bases.
Entre os exemplos mais recentes, é possível citar as 
\textit{Finite Element Neural Networks} \cite{mitusch:2021-hybrid-fem-nn}, 
que combinam redes neurais com o FEM, criando um método capaz de resolver problemas
diretos e inversos com reduzido custo computacional.

Entretanto, foi apenas com \cite{raissi-etal:19} e a introdução do conceito das 
\textit{Physics Informed Neural Networks} (PINNs) que se renovou o interesse 
em aplicar redes neurais para a solução de problemas científicos.
A grande diferença na abordagem das PINNs em relação a propostas anteriores, 
é tratar não apenas as equações que compõem o modelo, mas também as condições
de fronteira e iniciais, como residuais a serem minimizados pela função de perda.
Ou seja, tratando a solução de uma equação diferencial como um problema de
minimização, sendo as equações e as condições de fronteira e iniciais tratadas 
como restrições leves (\textit{soft constraints}). 
Outra inovação, é a incorporação de dados ao treinamento da rede neural, 
permitindo a descoberta de parâmetros do modelo, através da reformulação do 
mesmo como um problema inverso.
Inclusive, os autores elaboraram diversos experimentos com dados pertubados
para atestar a resiliência do método a dados ruídosos, indicando que PINNs
podem ser treinadas com dados comprometidos sem afetar drasticamente a qualidade
da solução obtida.
Outra possibilidade que o uso de dados proporciona,
é a descoberta de partes das equações que compõem o modelo,  

Esta abordagem foi possível com o desenvolvimento de técnicas de 
diferenciação automática (DA).
A importância que a DA tem para as PINNs está ligada ao fato de que incorporar
as equações do modelo a função de perda faz com que o cálculo da derivada 
para o algoritmo de retropropagação seja uma tarefa muito complexa. A diferenciação
automática permite que não seja necessário calcular uma derivada analítica, nem
utilizar derivdas númericas, que podem levar a erros de arredondamento.
Apesar da técnica ter sido desenvolvida ainda nos anos 60 e 70 com 
os trabalhos de \cite{wengert:64-diferenciao-automatica} 
para \textit{forward accumulation}, e \cite{linnainmaa:76-diferenciao-automatica} 
para \textit{inverse accumulation}, foi com sua incorporação à bibliotecas 
que implementam estes algoritmos como PyTorch \cite{pytorch:19} e 
TensorFlow \cite{tensorflow:16}, que facilitou o uso desta técnica,
e a adoção de funções de perda mais complexas. 

Desde sua concepção, PINNs vem sendo aplicadas para diversos problemas 
de engenharia, por exemplo, escoamento de fluxos incompressíveis 
\cite{jin-et-al:21-navier-stokes}. Solução de problemas de física, como
física quãntica como a equação de Schröndiger \cite{jin-etal:2022-schrondiger}
e modelos cosmologicos \cite{chantada-etal:2023-cosmologia}.
Pode-se também citar exemplos de aplicações para problemas de ecologia e química, 
como o problema de formação de padrões em modelos de reação-difusão, como em 
\cite{giampaolo-etal:22-gray-scott}.
Problemas envolvendo epidemiológia, como \cite{shaier-etal:22-dinns}, em que
os autores utilizam PINNs para ajustar modelos compartimentais para várias 
doenças como dengue, rubeola e gripe. Atestando a efetiviade das PINNs para 
problemas de epidemiológia modelados por equações diferencias.

Em epidemiológia, modelos compartimentais baseados em equações diferencias 
são modelos que separam a população em compartimentos e modelam fluxos de 
individuos entre estes compartimentos como proporcional ao tamanho dos 
compartimentos envolvdidos multiplicados por parâmetros. Estes parâmetros são
taxas que indicam a evolução da doença ao longo do tempo, como a taxa de invecção, 
taxa de mortalidade e taxa de imunização da população. Fazendo com que a variação 
total de cada compartimento ao longo do tempo, ou seja a diferenciação do mesmo 
em relação ao tempo, seja igual a soma destes fluxos.
Eles foram introduzidos por \cite{kermack-mcKendrick:1927}, ao proporem o modelo 
\textit{Susceptible-Infected-Removed} (\textit{SIR}), que se separa a população, 
como o nome indica, em sucetíveis, infectados e recuperados.
Modelos compartimentais são normalmente empregados em epidemiológia, 
em detrimento de modelos mais complexos, como aqueles baseados em agentes, 
por sua simplicidade e capacidade de indicar tendências a curto prazo 
na evolução de uma pandemia. 
Por serem modelos formados por um sistema de equações ordinárias que, se sabidas 
as condições iniciais de cada variável, ou seja o número inicial de individuos
em cada compartimento, tem-se um problema de valor inicial (PVI), que
pode ser facilmente resolvidos por métodos númericos mais simples, 
como o método de Runge-Kutta de quarta ordem.

Com a declaração da OMS (Organização Mundial de Saúde) em dezembro de 2019 da
pandemia de COVID-19, o mundo teve que adotar medidas para conter o avanço da 
doença, como isolamento social e uso de màscaras. Junto às medidas de contenção
da pandemia, governos mobilizaram os sistemas de saúde para coletar dados
e permiter aos gorvernantes e entidades responsáveis pela saúde publica, 
tomar decisões acerca das medidas restrição.  
Essas ações geraram uma quantidade grande de dados acerca da quantidade de casos
notificados, internações, tempo de internação e mortes causadas pela COVID-19.
Pesquisadores de diferentes áreas trabalharam em cima destes dados tentando
encaixá-los em modelos compartimentais para oferecer às autoridades projeções
da evolução da pandemia. As PINNs, que haviam sido propostas há pouco tempo, foram
logo encaradas como mais uma ferramenta a ser utilizada para a estimativa de 
parâmetros, sendo que estes podem ser usados para prover uma projeção da evolução
da doença.   

Pode-se citar \cite{long-etal:21-L2} como um dos primeiros trabalhos a utilizar
PINNs com modelos compartimentais para dados epidemiológicos. Os autores inovaram 
ao, não apenas utilizar PINNs para solucionar este problema, mas também ao modelar 
as taxas de variação entre os compartimentos como uma função que tem que ser
aproximada pela rede neural. A vantagem desta abordagem é considerar que medidas
de contenção do avanço da doença como isolamento social e vacinação da população
influenciam em taxas como infecção e mortalidade. Vale notar que no trabalho
mencionado os autores focaram nas taxas de transmissão, por períodos curtos de tempo,
e os modelos foram capazes de aproximar apenas funções monotônicas para os parâmetros.   

Neste trabalho é proposto uma abordagem utilizando PINNs para a indentificação 
de parâmetros em modelos compartimentais, considerando que há uma variabilidade
na taxa de transmissão ao longo tempo. O principal objetivo é averiguar se PINNs
são capazes de aproximar as taxas de infecção com precisão, mesmo que elas  
sigam diferentes tendências ao longo de um período considerável de tempo.
Para atingir este objetivo são feitos testes com dados sintéticos para avaliar
se as PINNs conseguem aproximar a taxa de infecção seguindo diferentes tipos de
função. 
Em seguida, os mesmos experimentos são repetidos, mas adicionando ruído aos
dados sintéticos, para avaliar a resiliência do método a dados ruidosos
Por fim, são realizados testes com dados reais.

O restante do trabalho está organizado da seguinte forma: 

No capítulo \ref{sec-pinns} são formalizados os conceitos de redes neurais e 
redes neurais informadas pela física, além de uma pequena revisão da literatura
sobre algumas das diferentes arquiteturas alternativas já propostas. 

No capítulo \ref{sec-modelos-compartimentais} são apresentados os modelos 
epidemiológicos compartimentais e são discutidas suas propriedades mais relavantes 
para a compreseensão do trabalho desenvolvido nesta dissertação, como pontos de 
equilíbrio e identificabilidade, além disto são apresentadas algumas das variantes
mais comuns. 
Também é feita uma pequena revisão da literatura sobre o uso de PINNs para a 
estimativa de parâmetros em modelos compartimentais.

No capítulo \ref{sec-proposta} são providos os detalhes do método proposto por este 
trabalho, como a arquitetura da rede e como o modelo compartimental escolhido é 
integrado à rede. São definidos os experimentos para averiguar a efetiviade
do método, tanto os experimentos com dados sintéticos quanto os com dados reais,
além dos métodos de avaliação dos resultados. 

No capítulo \ref{sec-avaliacao} são apresentados os resultados dos experimentos
propostos no cápitulo \ref{sec-proposta} é são feitas pequenas avaliações dos 
mesmos.

Por fim, no capítulo \ref{sec-conclusoes} são apresentadas as conclusões, lacunas
de pesquisa encontradas, e 
possibilidades de trabalhos fututos.    